{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\luisa\\\\Downloads\\\\Proyecto-geolocalizacion-main\\\\Proyecto-geolocalizacion-main\\\\frontend\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\n// frontend/src/App.js\nimport React, { useState, useEffect } from 'react';\nimport { BrowserRouter as Router, Routes, Route, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport AuthPage from './pages/AuthPage';\nimport Layout from './components/Layout'; // Nuevo componente Layout\nimport HomePage from './pages/HomePage';\nimport MyVideosPage from './pages/MyVideosPage';\nimport ExplorePage from './pages/ExplorePage'; // 游녣 1. Importa la nueva p치gina\nimport LibraryPage from './pages/LibraryPage'; // Hemos movido HomePage a su propio archivo\nimport { GoogleOAuthProvider } from '@react-oauth/google'; // 游녣 1. Importa el proveedor\n\n// Importa tus p치ginas futuras aqu칤:\n\nimport './App.css'; // Tus estilos globales\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst API_URL = 'http://localhost:5000/api/auth'; // Aseg칰rate de que esta URL sea correcta\n\nfunction AppContent() {\n  _s();\n  const [authToken, setAuthToken] = useState(localStorage.getItem('token'));\n  const [user, setUser] = useState(null); // Para guardar los detalles del usuario\n  const [loadingUser, setLoadingUser] = useState(true); // Estado de carga para el usuario\n  const navigate = useNavigate();\n\n  // Funci칩n para obtener los detalles del usuario\n  const fetchUserData = async token => {\n    try {\n      setLoadingUser(true);\n      // --- CAMBIOS AQU칈 ---\n      const res = await axios.get(`${API_URL}/me`, {\n        headers: {\n          // El header debe ser 'Authorization' y el valor 'Bearer <token>'\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      // --------------------\n      setUser(res.data);\n    } catch (err) {\n      console.error('Error al obtener los datos del usuario:', err.response ? err.response.data : err.message);\n      localStorage.removeItem('token');\n      setAuthToken(null);\n      setUser(null);\n    } finally {\n      setLoadingUser(false);\n    }\n  };\n  useEffect(() => {\n    if (authToken) {\n      fetchUserData(authToken);\n    } else {\n      setUser(null);\n      setLoadingUser(false); // No hay token, no necesitamos cargar usuario\n      // No redirigir aqu칤 para evitar bucles. AuthPage se encarga si no hay token.\n    }\n  }, [authToken]); // Se ejecuta cuando el token cambia\n\n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    setAuthToken(null);\n    // setUser(null); // Se limpia en el useEffect\n    navigate('/auth'); // Redirigir a la p치gina de autenticaci칩n al cerrar sesi칩n\n  };\n  const handleLoginSuccess = token => {\n    localStorage.setItem('token', token);\n    setAuthToken(token);\n    navigate('/'); // Redirigir a la p치gina de inicio despu칠s del login\n  };\n\n  // Muestra un loader mientras se carga la info del usuario\n  if (loadingUser && authToken) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading-screen\",\n      children: \"Cargando usuario...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 16\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    user: user,\n    onLogout: handleLogout,\n    children: /*#__PURE__*/_jsxDEV(Routes, {\n      children: authToken ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          path: \"/\",\n          element: /*#__PURE__*/_jsxDEV(HomePage, {\n            user: user\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 50\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/explore\",\n          element: /*#__PURE__*/_jsxDEV(ExplorePage, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 57\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 25\n        }, this), \" \", /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/library\",\n          element: /*#__PURE__*/_jsxDEV(LibraryPage, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 57\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 25\n        }, this), \" \", /*#__PURE__*/_jsxDEV(Route, {\n          path: \"*\",\n          element: /*#__PURE__*/_jsxDEV(HomePage, {\n            user: user\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 50\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true) :\n      /*#__PURE__*/\n      /* Si el usuario NO est치 autenticado, solo permite la ruta /auth */\n      _jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          path: \"/auth\",\n          element: /*#__PURE__*/_jsxDEV(AuthPage, {\n            setAuthToken: handleLoginSuccess\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 54\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"*\",\n          element: /*#__PURE__*/_jsxDEV(AuthPage, {\n            setAuthToken: handleLoginSuccess\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 50\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 9\n  }, this);\n}\n\n// Wrapper para usar useNavigate y otros hooks de react-router-dom\n_s(AppContent, \"bR4nb7Io2aGaLI6fAjn5Ff0jFjE=\", false, function () {\n  return [useNavigate];\n});\n_c = AppContent;\nfunction App() {\n  const googleClientId = \"8303532805-087cjtan1s681791bel1d1f0u70qkgnr.apps.googleusercontent.com\"; // 游녣 2. Pega tu ID de Cliente aqu칤\n\n  return /*#__PURE__*/_jsxDEV(GoogleOAuthProvider, {\n    clientId: googleClientId,\n    children: /*#__PURE__*/_jsxDEV(Router, {\n      children: /*#__PURE__*/_jsxDEV(AppContent, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 108,\n    columnNumber: 9\n  }, this);\n}\n_c2 = App;\nexport default App;\nvar _c, _c2;\n$RefreshReg$(_c, \"AppContent\");\n$RefreshReg$(_c2, \"App\");","map":{"version":3,"names":["React","useState","useEffect","BrowserRouter","Router","Routes","Route","useNavigate","axios","AuthPage","Layout","HomePage","MyVideosPage","ExplorePage","LibraryPage","GoogleOAuthProvider","jsxDEV","_jsxDEV","Fragment","_Fragment","API_URL","AppContent","_s","authToken","setAuthToken","localStorage","getItem","user","setUser","loadingUser","setLoadingUser","navigate","fetchUserData","token","res","get","headers","data","err","console","error","response","message","removeItem","handleLogout","handleLoginSuccess","setItem","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onLogout","path","element","_c","App","googleClientId","clientId","_c2","$RefreshReg$"],"sources":["C:/Users/luisa/Downloads/Proyecto-geolocalizacion-main/Proyecto-geolocalizacion-main/frontend/src/App.js"],"sourcesContent":["// frontend/src/App.js\nimport React, { useState, useEffect } from 'react';\nimport { BrowserRouter as Router, Routes, Route, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\n\nimport AuthPage from './pages/AuthPage';\nimport Layout from './components/Layout'; // Nuevo componente Layout\nimport HomePage from './pages/HomePage';\nimport MyVideosPage from './pages/MyVideosPage';\nimport ExplorePage from './pages/ExplorePage'; // 游녣 1. Importa la nueva p치gina\nimport LibraryPage from './pages/LibraryPage'; // Hemos movido HomePage a su propio archivo\nimport { GoogleOAuthProvider } from '@react-oauth/google'; // 游녣 1. Importa el proveedor\n\n// Importa tus p치ginas futuras aqu칤:\n\n\nimport './App.css'; // Tus estilos globales\n\nconst API_URL = 'http://localhost:5000/api/auth'; // Aseg칰rate de que esta URL sea correcta\n\nfunction AppContent() {\n    const [authToken, setAuthToken] = useState(localStorage.getItem('token'));\n    const [user, setUser] = useState(null); // Para guardar los detalles del usuario\n    const [loadingUser, setLoadingUser] = useState(true); // Estado de carga para el usuario\n    const navigate = useNavigate();\n\n    // Funci칩n para obtener los detalles del usuario\n    const fetchUserData = async (token) => {\n        try {\n            setLoadingUser(true);\n            // --- CAMBIOS AQU칈 ---\n            const res = await axios.get(`${API_URL}/me`, {\n                headers: {\n                    // El header debe ser 'Authorization' y el valor 'Bearer <token>'\n                    'Authorization': `Bearer ${token}` \n                }\n            });\n            // --------------------\n            setUser(res.data);\n        } catch (err) {\n            console.error('Error al obtener los datos del usuario:', err.response ? err.response.data : err.message);\n            localStorage.removeItem('token');\n            setAuthToken(null);\n            setUser(null);\n        } finally {\n            setLoadingUser(false);\n        }\n    };\n\n\n    useEffect(() => {\n        if (authToken) {\n            fetchUserData(authToken);\n        } else {\n            setUser(null);\n            setLoadingUser(false); // No hay token, no necesitamos cargar usuario\n            // No redirigir aqu칤 para evitar bucles. AuthPage se encarga si no hay token.\n        }\n    }, [authToken]); // Se ejecuta cuando el token cambia\n\n    const handleLogout = () => {\n        localStorage.removeItem('token');\n        setAuthToken(null);\n        // setUser(null); // Se limpia en el useEffect\n        navigate('/auth'); // Redirigir a la p치gina de autenticaci칩n al cerrar sesi칩n\n    };\n\n    const handleLoginSuccess = (token) => {\n        localStorage.setItem('token', token);\n        setAuthToken(token);\n        navigate('/'); // Redirigir a la p치gina de inicio despu칠s del login\n    };\n\n    // Muestra un loader mientras se carga la info del usuario\n    if (loadingUser && authToken) {\n        return <div className=\"loading-screen\">Cargando usuario...</div>;\n    }\n\n    return (\n        <Layout user={user} onLogout={handleLogout}>\n            <Routes>\n                {/* Si el usuario est치 autenticado, muestra estas rutas */}\n                {authToken ? (\n                    <>\n                        <Route path=\"/\" element={<HomePage user={user} />} />\n                        <Route path=\"/explore\" element={<ExplorePage />} /> {/* 游녣 3. A침ade la ruta para Exploraci칩n */}\n                        <Route path=\"/library\" element={<LibraryPage />} /> {/* 游녣 4. A침ade la ruta para Biblioteca */}\n                        <Route path=\"*\" element={<HomePage user={user} />} /> \n                    </>\n                ) : (\n                /* Si el usuario NO est치 autenticado, solo permite la ruta /auth */\n                    <>\n                        <Route path=\"/auth\" element={<AuthPage setAuthToken={handleLoginSuccess} />} />\n                        {/* Cualquier otra ruta redirige a la p치gina de autenticaci칩n */}\n                        <Route path=\"*\" element={<AuthPage setAuthToken={handleLoginSuccess} />} />\n                    </>\n                )}\n            </Routes>\n        </Layout>\n    );\n}\n\n// Wrapper para usar useNavigate y otros hooks de react-router-dom\nfunction App() {\n    const googleClientId = \"8303532805-087cjtan1s681791bel1d1f0u70qkgnr.apps.googleusercontent.com\"; // 游녣 2. Pega tu ID de Cliente aqu칤\n\n    return (\n        <GoogleOAuthProvider clientId={googleClientId}>\n            <Router>\n                <AppContent />\n            </Router>\n        </GoogleOAuthProvider>\n    );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}